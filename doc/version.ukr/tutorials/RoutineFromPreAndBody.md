# Рутина routineFromPreAndBody

Автоматичне створення рутин, що використовують мапи опцій.

При розробці програмного продукту до кожної його частини ставляться вимоги, котрі забезпечують стабільність роботи і зручність роботи з ним. Одну з вимог сформульовано в принципі [`SOLID`](https://en.wikipedia.org/wiki/SOLID) - «Принцип відкритості / закритості» ( Open-Closed Principle ) - програмні суті (класи, модулі, рутини і т.п.) повинні бути відкритими для розширення, але закритими для модифікації.

Таким чином, в життєвому циклі програмного продукту, код, що був написаний один раз повинен змінюватись мінімально. Це пов'язано з тим, що кожна зміна може порушити логіку функціонування проекту і викликати додаткові проблеми. А також, одночасно цей код повинен бути легко розширюваним, тобто, за необхідності, потрібно щоб введення нових функціональностей не порушувало роботу існуючих.

Іншими словами: повинна бути можливість розширити / змінити поведінку деякої програмної суті без зміни / переписування вже існуючих частин.

Додатково висувається вимога можливості повторного використання коду.

Рутина `routineFromPreAndBody` модуля `Tools` допомагає втілити ці вимоги при побудові вашого програмного продукту.

### Використання рутини `routineFromPreAndBody`

Рутина `routineFromPreAndBody` призначена для автоматичного створення рутин. Назва рутини говорить сама за себе - вона повертає рутину складену з двох частин - `pre` i `body`. Кожна з указаних частин це окрема рутина з власним функціоналом.

Рутина `pre` призначена для підготовки мапи опцій, котра передається в рутину `body`. В рутині `body`, власне, виконується обробка даних, вона приймає мапу опцій і має опції за замовчуванням. Таке розділення функцій зручне з декількох сторін:

- рутина `pre` може повторно використовуватись в рутинах, які приймають мапу опцій з подібним набором полів;
- зміною опцій за замовчуванням можливо створити нові рутини на основі рутини `body`;
- поведінка рутини `body` може змінюватись в залежності від підготовленої мапи опцій в рутині `pre`;

### Створення рутин з допомогою `routineFromPreAndBody`

<details>
  <summary><u>Структура файлів</u></summary>

```
routineFromPreAndBody
        ├── Name.js
        └── package.json

```

</details>

Створіть приведену конфігурацію для дослідження рутини `routineFromPreAndBody`.

<details>
  <summary><u>Код файла <code>Name.js</code></u></summary>

```js
let _ = require( 'wTools' );

//

function name_pre( routine, args )
{
  let o = args[ 0 ];
  if( _.strIs( o ) )
  o = { path : o };

  _.routineOptions( routine, o );
  _.assert( o && _.strIs( o.path ), 'Expects strings {-o.path-}' );
  _.assert( args.length === 1 );
  _.assert( arguments.length === 2 );

  return o;
}

function name_body( o )
{
  let i = o.path.lastIndexOf( '/' );
  if( i !== -1 )
  o.path = o.path.substr( i+1 );

  if( !o.full )
  {
    let i = o.path.lastIndexOf( '.' );
    if( i !== -1 ) o.path = o.path.substr( 0, i );
  }

  return o.path;
}

name_body.defaults =
{
  path : null,
  full : 0,
}

let name = _.routineFromPreAndBody( name_pre, name_body );
```

</details>
