# Тип unroll

Unroll - тип даних - особливий вид масиву, здатний розготатись в іншому масиві при виконанні операції над ним.

При виконанні над unroll-масивом операцій як зі звичайним масивом, він веде себе як звичайний масив і не змінює свого типу. До операцій зі звичайними масивами належать рутини сімейств Prepend, Append, Remove, Replace, Flatten.

Якщо виконуються операції для роботи з unroll-масивом, то вкладені unroll-масиви розгортаються. Результат розгортання залежить від того, який масив знаходиться ззовні:
- якщо зовнішній масив (масив призначення) звичайний, то результатом виконання рутини буде звичайний масив;
- якщо зовнішній масив (масив призначення) - unroll-масив, то результатом також буде unroll-масив.

Якщо масив має декілька рівнів вкладення, то вкладені unroll-масиви розгортаються до найближчого звичайного масиву. Якщо на всіх рівнях вкладення знаходяться unroll-масиви, то такий масив розгортається до одномірного unroll-масиву.

Рутини призначені для роботи з unroll-масивами можна виконувати над звичайними масивами. Така рутина не змінює тип масиву.

### Приклади

Виконання над unroll-масивом операції звичайного масиву.

```js
// unroll array
var unroll = _.unrollMake( [ 2, 3, 4 ] );

var result = _.arrayAppend( unroll, 5 );
// returns [ 2, 3, 4, 5 ]
_.unrollIs( result );
//returns true
```

Виконання над звичайним масивом операції для unroll-масивів

```js
var result = _.unrollAppend( [ 0, 1, 2, 3 ], 4 );
// returns [ 0, 1, 2, 3, 4 ]
_.unrollIs( result );
// returns false
```

Додавання елементів до unroll-масиву рутиною для роботи з unroll-масивами

```js
var unroll = _.unrollMake( [ 0, 1, 'str' ] );
var result = _.unrollPrepend( unroll, [ 2 ], 3, unroll );  
// returns [ [ 2 ], 3, 0, 1, 'str', 0, 1, 'str' ]
_.unrollIs( result );
// returns true
```

Додавання елементів до звичайного-масиву рутиною для роботи з unroll-масивами

```js
var unroll = _.unrollMake( [ 0, 1, 'str' ] );
var result = _.unrollPrepend( [ 7 ], [ 2 ], 3, unroll );  
// returns [ [ 2 ], 3, 0, 1, 'str', 7 ]
_.unrollIs( result );
// returns false
```

Розгортання unroll-масивів при різних варіантах вкладення

```js
var result1 = _.unrollNormalize( _.unrollFrom( [ 1, 2, _.unrollFrom( [ 'str', 3, [ 4, _.unrollMake( [ '5' ] ) ] ] ) ] ) );  
// returns [ 1, 2, 'str', 3, [ 4, '5' ] ]
_.unrollIs( result1 );
//returns true

var result2 = _.unrollNormalize( [ 0, 7, _.unrollFrom( [ 1, 2, [ _.unrollFrom( [ 'str', 3, [ 4, _.unrollMake( [ '5' ] ) ] ] ) ] ] ) ] );
// returns [ 0, 7, 1, 2, [ 'str', 3, [ 4, '5' ] ] ]
_.unrollIs( result2 );
// returns false
```

### Підсумок

- При виконанні над unroll-масивом операції для звичайного масиву, він веде себе як звичайний масив.
- При виконанні над вкладеним unroll-масивом операції для unroll-масивів такий масив розгортається.
- Unroll-масиви здатні розгортатись в інших unroll-масивах та звичайних масивах.
- Рутини для виконання операцій над unroll-масивами повертають unroll-масив, якщо масив призначення - unroll-масив або звичайний масив, якщо масив призначення - звичайний.

[Повернутись до змісту](../README.md#Концепції)
