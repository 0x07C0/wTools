# Тип <code>unroll</code>

<code>Unroll</code> - тип даних - особливий вид масиву, здатний розготатись в іншому масиві при виконанні операції над ним.

При виконанні над `unroll-масивом` операцій як зі звичайним масивом, він веде себе як звичайний масив і не змінює свого типу. Над `unroll-масивами` можливо виконувати операції, як і над звичайним масивом: `Prepend`, `Append`, `Remove`, `Replace`, `Flatten`. Якщо виконуються операції рутинами, в назві яких є префікс `unroll`, то вкладення `unroll-масивів` розгортається. В результаті розгортання `unroll-масивів`, кожен елемент `unroll-масиву` стане елементом масиву в якому знаходився `unroll-масив`, а сам `unroll-масив` перестане бути елементом свого контейнера -- відбудеться розгортання.

Результатом операції над багато-рівневим масивом `unroll-масивів` в якому є інші `unroll-масиви` буде плоский масив, що складається із елементів, котрі містилися в вкладених `unroll-масивах`. Якщо масив має декілька рівнів вкладення, то вкладені `unroll-масиви` розгортаються до найближчого звичайного масиву. Якщо на всіх рівнях вкладення знаходяться `unroll-масиви`, то такий масив розгортається до плаского масиву.

Рутини призначені для роботи з `unroll-масивами` можна виконувати над звичайними масивами. Така рутина не змінює тип масиву.

### Приклади

Виконання над `unroll-масивом` операції звичайного масиву

```js
var unroll = _.unrollMake([ 2, 3, 4 ]);
var result = _.arrayAppend( unroll, 5 );
// returns [ 2, 3, 4, 5 ]
_.unrollIs( result );
// returns true
```

В `unroll-масив` додано елемент. Результуючий масив залишився `unroll`-ом.

Виконання над звичайним масивом операції для `unroll-масивів`

```js
var result = _.unrollAppend( [ 0, 1, 2, 3 ], 4 );
// returns [ 0, 1, 2, 3, 4 ]
_.unrollIs( result );
// returns false
```

Якщо застосувати `unroll-рутину` до звичайного масиву, то буде виконано указану операцію як зі звичайним масивом. При цьому `unroll-рутини` не змінюють тип оригінального масиву.

Додавання елементів до `unroll-масиву` рутиною для роботи з `unroll-масивами`

```js
var unroll1 = _.unrollMake([ 2 ]);
var unroll2 = _.unrollMake( [ 0, 1, 'str' ] );
var result = _.unrollAppend( unroll1, unroll2 );
// returns [ 2, 0, 1, 'str' ]
```

При додаванні `unroll-рутиною` до одного `unroll-масиву` іншого, відбувається розгортання. Результуючий масив `result` містить як елементи першого масиву, так і другого.

Додавання елементів до звичайного-масиву рутиною для роботи з `unroll-масивами`

```js
var unroll = _.unrollMake( [ 0, 1, 'str' ] );
var result = _.unrollAppend( [ 7, [ 2 ] ], unroll );
// returns [ 7, [ 2 ], 0, 1, 'str' ]
```

При додаванні `unroll-рутиною` до одного звичайного масиву `unroll-масиву`, відбувається розгортання. Результуючий масив `result` не змінює типу та включає елементи `unroll-масива`.

Розгортання `unroll-масивів` в `unroll-масиві`

```js
var unroll1 = _.unrollMake( [ '5' ] );
var unroll2 = _.unrollMake( [ 'str', 3, [ 4 ] ] );
var result1 = _.unrollNormalize( _.unrollFrom( [ 1, 2, unroll1, unroll2 ] ) );
// returns [ 1, 2, '5', 'str', 3, [ 4 ] ]
```

При використанні рутини `unrollNormalize` вкладені в `unroll-масив` `unroll-масиви` розгортаються. Оригінальний `unroll-масив` при цьому не змінює тип.

Розгортання `unroll-масивів` в звичайному масиві

```js
var unroll1 = _.unrollMake( [ '5' ] );
var unroll2 = _.unrollMake( [ 'str', [ 3 ] ] );
var result2 = _.unrollNormalize( [ 0, 7, unroll1, [ unroll2, unroll1 ] ] );
// returns [ 0, 7, '5', [ 'str', [ 3 ],  '5' ] ]
_.unrollIs( result2 );
// returns false
```

При використанні рутини `unrollNormalize` вкладені в звичайний масив `unroll-масиви` розгортаються. Оригінальний масив при цьому не змінює тип.

### Підсумок

- При виконанні над вкладеним `unroll-масивом` операції для `unroll-масивів`, такий масив розгортається.
- При виконанні над `unroll-масивом` операції для звичайного масиву, він веде себе як звичайний масив.
- `Unroll-масиви` здатні розгортатись в інших `unroll-масивах` та в звичайних масивах.

[Повернутись до змісту](../README.md#Концепції)
